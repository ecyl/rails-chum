<!--- Find me in app/views/pages/home.html.erb -->
<div class="bg-white pb-5">
  <div class="home-banner">
    <h1><strong>Discover buddies for your next trip</strong></h1>
    <div class="banner-text">
      <p>Chum is an online service that connects travellers in Singapore before they hit the road.</p>
    </div>

    <div class="search-container w-50">
      <div class="home-search-card">
        <p><strong>Hi, where do you want to go?</strong></p>
        <hr class="text-muted">

        <%= form_with url: itineraries_path, method: :get, html: { class: 'd-flex justify-content-between mb-3',
        data: { search_itineraries_target: 'form' } } do |f| %>
          <div class="d-flex flex-column">
            <%= f.label :query, "Destination", class: "text-muted mb-2" %>
            <%= f.text_field :query,
                              class: "form-control",
                              placeholder: "Type a destination...",
                              value: params[:query],
                              data: {
                                search_itineraries_target: 'input',
                              }
                              %>

          </div>
          <div class="d-flex flex-column justify-content-end">
            <%= submit_tag "Search", class: "btn-orange normal" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Intro text -->
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12">
        <div class="intro-container">
          <h3><strong>A New Adventure Awaits</strong></h3>
          <p>Can’t get your family or friends to travel together because everyone’s too busy?
          You don't have to give up on your travel plans, for ready-made itineraries are just a click away.</p>
          <p>Join trips organized by solo-travellers, or be an organizer and plan trips for others to join</p>
        </div>
      </div>
    </div>
  </div>
  <!-- Some itineraries -->
  <div class="itineraries-container">
    <div class="row">
      <div class="col-12">
        <div class="section-header">
          <h2><strong>Explore Itineraries</strong></h2>
        </div>
      </div>
    </div>
    <div class="row mb-5">
      <div class="col-12 col-sm-9">
        <p>Want someone to share the journey with? Checkout itineraries of upcoming trips.</p>
      </div>
      <div class="col-12 col-sm-3">
        <%= link_to "More", itineraries_path, class:"btn-black medium" %>
      </div>
    </div>

    <!-- Itinerary cards -->
    <div class="row" data-controller="itinerary-card">
      <% 6.times do |i| %>
        <div class="col-12 col-md-4 mb-4">
          <%= link_to itinerary_path(@itineraries[i]), class: "text-decoration-none" do %>

            <div class="trip-card" data-action='click->itinerary-card#clickCard' data-itinerary-card-target="card" data-itinerary-id="<%= @itineraries[i].id %>">
              <!-- background image -->
              <div class="trip-card-background">
                <% if @itineraries[i].photo.attached? %>
                  <img class="itinerary-image" src="<%= cl_image_path @itineraries[i].photo.key %>" alt="itinerary image">
                <% else %>
                  <!-- TODO: This needs to match the itinerary banner image in the show page -->
                  <img src="https://source.unsplash.com/random/430x246/?trip,<%= @itineraries[i].title %>" alt="itinerary image">
                <% end %>
              </div>
              <div class="black-overlay">
                <div class="trip-card-content">
                  <div class="trip-card-destination">
                    <p><%= @itineraries[i].destination %></p>
                  </div>
                  <div class="trip-card-title">
                    <h2><%= @itineraries[i].title %></h2>
                    <p>by <%= @itineraries[i].user.first_name %> <%= @itineraries[i].user.last_name %></p>
                  </div>
                  <div class="trip-card-specs">
                    <div class="trip-card-dates">
                      <div>
                        <p class="trip-card-date-header">From</p>
                        <p><%= @itineraries[i].events[0].date_start.strftime('%d %B %Y') %></p>
                      </div>
                      <div>
                        <p class="trip-card-date-header">To</p>
                        <p><%= @itineraries[i].events[-1].date_end.strftime('%d %B %Y') %></p>
                      </div>
                    </div>
                    <% budget = 0 %>
                    <% @itineraries[i].events.each { |event| budget += event.cost }%>
                    <div class="trip-card-budget">
                      <p class="trip-card-budget-header">Budget</p>
                      <p>SGD <%= budget.round %></p>
                    </div>
                  </div>
                </div>

              </div>
            </div>

          <% end %>
        </div>
      <% end %>
    </div>
  </div>
</div>
